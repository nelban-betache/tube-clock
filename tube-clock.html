<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Nixie Tube Clock</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0a0f;
    --text: #e8e0d0;
    --text-dim: #6a6a7a;
    --neon-orange: #ff7f00;
    --neon-amber: #ffb700;
    --neon-green: #39ff14;
    --neon-pink: #ff2d78;
    --neon-cyan: #00f5ff;
    --neon-blue: #4d79ff;
    --panel: #16161e;
    --panel-border: #252535;
  }
  [data-theme="light"] {
    --bg: #dedad0;
    --text: #1a1a2e;
    --text-dim: #5a5a7a;
    --panel: #ccc8bc;
    --panel-border: #b0ac9e;
  }

  html, body { width: 100%; min-height: 100vh; }

  body {
    font-family: 'Share Tech Mono', monospace;
    background: var(--bg);
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    transition: background 0.4s, color 0.4s;
    padding: 16px;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: radial-gradient(ellipse 70% 50% at 50% 45%, rgba(255,127,0,0.05) 0%, transparent 70%);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.6s;
  }
  body.clock-on::before { opacity: 1; }

  /* Theme toggle */
  .theme-toggle {
    position: fixed;
    top: 14px; right: 14px;
    z-index: 200;
    background: var(--panel);
    border: 1px solid var(--panel-border);
    border-radius: 50px;
    padding: 7px 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    color: var(--text);
    font-family: 'Share Tech Mono', monospace;
    font-size: 11px;
    letter-spacing: 1px;
    transition: all 0.3s;
    white-space: nowrap;
  }
  .theme-toggle:hover { border-color: var(--neon-amber); color: var(--neon-amber); }

  /* Wrapper */
  .clock-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    width: 100%;
    max-width: 700px;
  }

  .clock-title {
    font-family: 'Orbitron', monospace;
    font-size: clamp(11px, 3.5vw, 18px);
    letter-spacing: clamp(3px, 1.5vw, 8px);
    color: var(--text-dim);
    text-transform: uppercase;
    font-weight: 400;
    text-align: center;
    margin-top: 48px;
  }

  /* Device panel */
  .device {
    background: linear-gradient(160deg, #1e1e2e 0%, #141420 100%);
    border: 2px solid var(--panel-border);
    border-radius: 20px;
    padding: 28px 20px 44px;
    box-shadow: 0 24px 70px rgba(0,0,0,0.7), 0 0 0 1px rgba(255,255,255,0.03) inset, 0 2px 0 rgba(255,255,255,0.05) inset;
    position: relative;
    width: 100%;
  }
  [data-theme="light"] .device {
    background: linear-gradient(160deg, #c8c4b8 0%, #d8d4c8 100%);
    border-color: #a8a49a;
    box-shadow: 0 16px 40px rgba(0,0,0,0.18), 0 0 0 1px rgba(255,255,255,0.5) inset;
  }

  .device-brand {
    position: absolute;
    bottom: 14px; left: 50%;
    transform: translateX(-50%);
    font-family: 'Orbitron', monospace;
    font-size: 8px;
    letter-spacing: 3px;
    color: var(--text-dim);
    opacity: 0.4;
    white-space: nowrap;
  }

  .screw {
    position: absolute;
    width: 10px; height: 10px;
    border-radius: 50%;
    background: radial-gradient(circle at 35% 35%, #3a3a5a, #1a1a28);
    border: 1px solid rgba(255,255,255,0.05);
    box-shadow: 0 2px 3px rgba(0,0,0,0.5);
  }
  .screw::after { content:''; position:absolute; inset:3px; border-top:1px solid rgba(255,255,255,0.08); border-radius:50%; }
  .screw.tl { top:12px; left:12px; }
  .screw.tr { top:12px; right:12px; }
  .screw.bl { bottom:26px; left:12px; }
  .screw.br { bottom:26px; right:12px; }

  /* Tubes area */
  .tubes-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
  }

  .tubes-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    flex-wrap: nowrap;
  }

  /* Colon separator */
  .separator {
    display: flex;
    flex-direction: column;
    gap: 7px;
    padding: 0 2px;
    opacity: 0;
    transition: opacity 0.5s;
    flex-shrink: 0;
  }
  .separator.visible { opacity: 1; }

  .sep-dot {
    width: 7px; height: 7px;
    border-radius: 50%;
    background: var(--neon-amber);
    box-shadow: 0 0 8px var(--neon-amber), 0 0 16px var(--neon-amber);
    animation: blink 1s infinite;
    flex-shrink: 0;
  }
  @keyframes blink { 0%,100%{opacity:1;} 50%{opacity:0.15;} }

  /* Tube */
  .tube {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
  }

  .tube-label {
    font-size: 8px;
    letter-spacing: 2px;
    color: var(--text-dim);
    text-transform: uppercase;
    opacity: 0;
    transition: opacity 0.5s;
    white-space: nowrap;
  }
  .tube-label.visible { opacity: 0.55; }

  /* Glass ‚Äî sized via CSS var */
  .tube-glass {
    --tw: 70px;
    --th: 100px;
    position: relative;
    width: var(--tw);
    height: var(--th);
    background: linear-gradient(180deg, #0c0c18 0%, #181828 50%, #0c0c18 100%);
    border: none;
    border-radius: 10px 10px 7px 7px;
    overflow: hidden;
    transition: box-shadow 0.5s;
    box-shadow: 0 4px 18px rgba(0,0,0,0.6), 2px 0 8px rgba(0,0,0,0.4) inset;
    flex-shrink: 0;
  }
  .tube-glass::before {
    content:'';
    position:absolute; left:3px; top:3px; bottom:3px;
    width:28%;
    background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, transparent 100%);
    border-radius: 5px 0 0 5px;
    pointer-events:none; z-index:5;
  }
  .tube-glass::after {
    content:'';
    position:absolute; top:0; left:10%; right:10%; height:2px;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.12), transparent);
    border-radius: 0 0 3px 3px;
  }

  .tube-glow-inner {
    position:absolute; inset:0;
    background: transparent;
    transition: background 0.5s;
    z-index:1; pointer-events:none;
  }
  .tube-glass.active .tube-glow-inner {
    background: radial-gradient(ellipse at 50% 65%, rgba(255,100,0,0.13) 0%, transparent 70%);
  }

  .tube-digit {
    position:absolute; inset:0;
    display:flex; align-items:center; justify-content:center;
    font-family: 'Orbitron', monospace;
    font-weight: 900;
    font-size: calc(var(--th) * 0.46);
    color: transparent;
    transition: color 0.3s, text-shadow 0.3s;
    z-index:2;
    user-select:none;
    letter-spacing: -1px;
  }
  .tube-digit.off {
    color: rgba(90,90,110,0.13);
    text-shadow: none;
  }
  .tube-digit.on {
    color: var(--neon-amber);
    text-shadow: 0 0 8px var(--neon-amber), 0 0 18px var(--neon-orange), 0 0 36px var(--neon-orange), 0 0 70px rgba(255,127,0,0.45);
    animation: flicker 9s infinite;
  }
  @keyframes flicker {
    0%,100%{opacity:1;} 91%{opacity:1;} 92%{opacity:0.82;} 93%{opacity:1;} 96%{opacity:0.88;} 97%{opacity:1;}
  }
  @keyframes tubeOn {
    0%{opacity:0;transform:scaleY(0.75);} 25%{opacity:0.7;} 50%{opacity:0.35;} 70%{opacity:0.9;} 85%{opacity:0.65;} 100%{opacity:1;transform:scaleY(1);}
  }
  .tube-digit.booting { animation: tubeOn 0.65s ease-out forwards; }

  .tube-base {
    height: 12px;
    width: 80%;
    background: linear-gradient(90deg, #1a1a28, #25253e, #1a1a28);
    border-radius: 0 0 4px 4px;
    display: flex; align-items: center; justify-content: space-around;
    padding: 0 6px;
  }
  .tube-pin { width:2px; height:7px; background: linear-gradient(180deg,#777,#3a3a3a); border-radius:1px; }

  /* Controls */
  .controls-area {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    margin-top: 20px;
  }

  .date-display {
    font-size: clamp(9px, 2.5vw, 13px);
    letter-spacing: clamp(2px, 1vw, 4px);
    color: transparent;
    text-align: center;
    transition: color 0.5s, text-shadow 0.5s;
    text-transform: uppercase;
    white-space: nowrap;
  }
  .date-display.visible {
    color: var(--neon-green);
    text-shadow: 0 0 10px var(--neon-green), 0 0 22px rgba(57,255,20,0.35);
  }

  .switch-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }
  .switch-label {
    font-size: 9px;
    letter-spacing: 4px;
    color: var(--text-dim);
    text-transform: uppercase;
  }

  .power-switch {
    position: relative;
    width: 68px; height: 68px;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
    flex-shrink: 0;
  }
  .switch-ring {
    position: absolute; inset: 0;
    border-radius: 50%;
    background: linear-gradient(145deg, #252535, #1a1a28);
    border: 2px solid rgba(255,255,255,0.05);
    box-shadow: 0 5px 18px rgba(0,0,0,0.6), 0 2px 3px rgba(255,255,255,0.04) inset, 0 -2px 4px rgba(0,0,0,0.4) inset;
    transition: box-shadow 0.35s, border-color 0.35s;
  }
  [data-theme="light"] .switch-ring {
    background: linear-gradient(145deg, #bebbb0, #cecbb8);
    border-color: rgba(0,0,0,0.08);
    box-shadow: 0 5px 16px rgba(0,0,0,0.18), 0 2px 3px rgba(255,255,255,0.6) inset;
  }
  .switch-button {
    position: absolute; inset: 9px;
    border-radius: 50%;
    background: linear-gradient(145deg, #1e1e30, #141420);
    border: 1px solid rgba(255,255,255,0.04);
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.15s, box-shadow 0.35s;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5), 0 1px 2px rgba(255,255,255,0.03) inset;
  }
  [data-theme="light"] .switch-button {
    background: linear-gradient(145deg, #b0add0, #c0bdb0);
    border-color: rgba(255,255,255,0.35);
  }
  .power-switch:active .switch-button { transform: scale(0.92); }

  .power-icon svg { width:24px; height:24px; }
  .power-icon svg path, .power-icon svg circle {
    stroke: #3a3a5a;
    transition: stroke 0.4s, filter 0.4s;
  }
  [data-theme="light"] .power-icon svg path,
  [data-theme="light"] .power-icon svg circle { stroke: #7070a0; }

  .power-switch.active .switch-ring {
    border-color: rgba(255,180,0,0.35);
    box-shadow: 0 0 18px rgba(255,127,0,0.55), 0 0 38px rgba(255,127,0,0.18), 0 5px 18px rgba(0,0,0,0.6), 0 2px 3px rgba(255,255,255,0.04) inset;
  }
  .power-switch.active .power-icon svg path,
  .power-switch.active .power-icon svg circle {
    stroke: var(--neon-amber);
    filter: drop-shadow(0 0 5px var(--neon-amber)) drop-shadow(0 0 10px var(--neon-orange));
  }

  .status-text {
    font-size: 10px;
    letter-spacing: 4px;
    text-transform: uppercase;
    color: var(--text-dim);
    transition: color 0.4s;
    min-height: 14px;
    text-align: center;
  }
  .status-text.on { color: var(--neon-amber); }

  .color-picker {
    display: flex;
    gap: 12px;
    align-items: center;
    opacity: 0;
    transition: opacity 0.5s;
    pointer-events: none;
  }
  .color-picker.visible { opacity:1; pointer-events:all; }

  .color-dot {
    width: 15px; height: 15px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: transform 0.2s, border-color 0.2s;
    flex-shrink: 0;
  }
  .color-dot:hover { transform:scale(1.3); }
  .color-dot.active { border-color: white; transform:scale(1.2); }
  .color-dot[data-color="amber"] { background:var(--neon-amber); box-shadow:0 0 7px var(--neon-amber); }
  .color-dot[data-color="green"] { background:var(--neon-green);  box-shadow:0 0 7px var(--neon-green); }
  .color-dot[data-color="cyan"]  { background:var(--neon-cyan);   box-shadow:0 0 7px var(--neon-cyan); }
  .color-dot[data-color="pink"]  { background:var(--neon-pink);   box-shadow:0 0 7px var(--neon-pink); }
  .color-dot[data-color="blue"]  { background:var(--neon-blue);   box-shadow:0 0 7px var(--neon-blue); }

  /* ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
     RESPONSIVE
  ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ */

  /* Desktop ‚â•600px ‚Äî one row, bigger tubes */
  @media (min-width: 600px) {
    .tube-glass      { --tw: 82px; --th: 118px; }
    .tubes-row       { gap: 12px; }
    .sep-dot         { width: 9px; height: 9px; }
    .separator       { gap: 8px; }
    .device          { padding: 36px 40px 50px; }
    /* hide mobile-only row */
    #rowBottom       { display: none; }
    .sep-mobile      { display: none; }
    .tube-mobile     { display: none; }
  }

  /* Mobile <600px ‚Äî split into 2 rows: HH:MM / :SS */
  @media (max-width: 599px) {
    .tube-glass      { --tw: 60px; --th: 88px; }
    .tubes-row       { gap: 6px; }
    .sep-dot         { width: 6px; height: 6px; }
    .separator       { gap: 6px; }
    .device          { padding: 22px 14px 40px; border-radius: 16px; }
    .clock-title     { margin-top: 42px; }
    .tube-base       { display: none; }
    /* hide desktop-only elements from top row */
    .sep-desktop     { display: none; }
    .tube-desktop    { display: none; }
  }

  /* Tiny phones <360px */
  @media (max-width: 360px) {
    .tube-glass      { --tw: 50px; --th: 74px; }
    .tubes-row       { gap: 4px; }
    .sep-dot         { width: 5px; height: 5px; }
  }
</style>
</head>
<body>

<button class="theme-toggle" onclick="toggleTheme()">
  <span id="themeIcon">‚òÄÔ∏è</span>
  <span id="themeLabel">LIGHT</span>
</button>

<div class="clock-wrapper">
  <div class="clock-title">NIXIE TUBE CLOCK</div>

  <div class="device">
    <div class="screw tl"></div>
    <div class="screw tr"></div>
    <div class="screw bl"></div>
    <div class="screw br"></div>

    <div class="tubes-area">

      <!-- ‚îÄ‚îÄ ROW 1: HH : MM (+ seconds on desktop) ‚îÄ‚îÄ -->
      <div class="tubes-row" id="rowTop">

        <div class="tube">
          <div class="tube-label" id="lbl-h">HOUR</div>
          <div class="tube-glass" id="glass-h1">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-h1">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>

        <div class="tube">
          <div class="tube-label" style="opacity:0">&nbsp;</div>
          <div class="tube-glass" id="glass-h2">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-h2">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>

        <div class="separator" id="sep1">
          <div class="sep-dot"></div>
          <div class="sep-dot"></div>
        </div>

        <div class="tube">
          <div class="tube-label" id="lbl-m">MIN</div>
          <div class="tube-glass" id="glass-m1">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-m1">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>

        <div class="tube">
          <div class="tube-label" style="opacity:0">&nbsp;</div>
          <div class="tube-glass" id="glass-m2">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-m2">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>

        <!-- Desktop only: second colon + seconds -->
        <div class="separator sep-desktop" id="sep2">
          <div class="sep-dot"></div>
          <div class="sep-dot"></div>
        </div>
        <div class="tube tube-desktop">
          <div class="tube-label" id="lbl-s">SEC</div>
          <div class="tube-glass" id="glass-s1">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-s1">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>
        <div class="tube tube-desktop">
          <div class="tube-label" style="opacity:0">&nbsp;</div>
          <div class="tube-glass" id="glass-s2">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-s2">0</div>
          </div>
          <div class="tube-base"><div class="tube-pin"></div><div class="tube-pin"></div><div class="tube-pin"></div></div>
        </div>

      </div><!-- /rowTop -->

      <!-- ‚îÄ‚îÄ ROW 2: :SS ‚Äî mobile only ‚îÄ‚îÄ -->
      <div class="tubes-row" id="rowBottom">

        <div class="separator sep-mobile" id="sep2m">
          <div class="sep-dot"></div>
          <div class="sep-dot"></div>
        </div>

        <div class="tube tube-mobile">
          <div class="tube-label" id="lbl-sm">SEC</div>
          <div class="tube-glass" id="glass-s1m">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-s1m">0</div>
          </div>
        </div>

        <div class="tube tube-mobile">
          <div class="tube-label" style="opacity:0">&nbsp;</div>
          <div class="tube-glass" id="glass-s2m">
            <div class="tube-glow-inner"></div>
            <div class="tube-digit off" id="digit-s2m">0</div>
          </div>
        </div>

      </div><!-- /rowBottom -->

    </div><!-- /tubes-area -->

    <!-- Controls -->
    <div class="controls-area">
      <div class="date-display" id="dateDisplay">‚Äî</div>

      <div class="switch-section">
        <div class="switch-label">POWER</div>
        <div class="power-switch" id="powerSwitch" onclick="toggleClock()">
          <div class="switch-ring"></div>
          <div class="switch-button">
            <div class="power-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2v6"/>
                <circle cx="12" cy="14" r="8"/>
              </svg>
            </div>
          </div>
        </div>
        <div class="status-text off" id="statusText">STANDBY</div>
      </div>

      <div class="color-picker" id="colorPicker">
        <div class="color-dot active" data-color="amber" onclick="setColor('amber')"></div>
        <div class="color-dot" data-color="green"  onclick="setColor('green')"></div>
        <div class="color-dot" data-color="cyan"   onclick="setColor('cyan')"></div>
        <div class="color-dot" data-color="pink"   onclick="setColor('pink')"></div>
        <div class="color-dot" data-color="blue"   onclick="setColor('blue')"></div>
      </div>
    </div>

    <div class="device-brand">NIXIE CHRONO ¬∑ MODEL NCX-1</div>
  </div>
</div>

<script>
let isOn = false;
let clockInterval = null;
let currentColor = 'amber';

const neonColors = {
  amber: { color:'#ffb700', g1:'#ff7f00', g2:'rgba(255,127,0,0.5)',  bg:'rgba(255,100,0,0.14)' },
  green: { color:'#39ff14', g1:'#2ae010', g2:'rgba(57,255,20,0.5)',  bg:'rgba(57,255,20,0.1)'  },
  cyan:  { color:'#00f5ff', g1:'#00c8ff', g2:'rgba(0,245,255,0.5)',  bg:'rgba(0,245,255,0.1)'  },
  pink:  { color:'#ff2d78', g1:'#ff0060', g2:'rgba(255,45,120,0.5)', bg:'rgba(255,45,120,0.12)'},
  blue:  { color:'#4d79ff', g1:'#2255ff', g2:'rgba(77,121,255,0.5)', bg:'rgba(77,121,255,0.12)'},
};

function isMobile() { return window.innerWidth < 600; }

function setDigitEl(id, val, boot) {
  const el = document.getElementById(id);
  if (!el) return;
  el.textContent = val;
  if (isOn) {
    el.classList.remove('off');
    el.classList.add('on');
    const c = neonColors[currentColor];
    el.style.color = c.color;
    el.style.textShadow = `0 0 8px ${c.color},0 0 18px ${c.g1},0 0 36px ${c.g1},0 0 70px ${c.g2}`;
    if (boot) {
      el.classList.add('booting');
      setTimeout(() => el.classList.remove('booting'), 700);
    }
  } else {
    el.classList.remove('on');
    el.classList.add('off');
    el.style.color = '';
    el.style.textShadow = '';
  }
}

function updateAllDigits(boot = false) {
  const now = new Date();
  const h = String(now.getHours()).padStart(2,'0');
  const m = String(now.getMinutes()).padStart(2,'0');
  const s = String(now.getSeconds()).padStart(2,'0');

  setDigitEl('digit-h1', h[0], boot);
  setDigitEl('digit-h2', h[1], boot);
  setDigitEl('digit-m1', m[0], boot);
  setDigitEl('digit-m2', m[1], boot);

  if (isMobile()) {
    setDigitEl('digit-s1m', s[0], boot);
    setDigitEl('digit-s2m', s[1], boot);
  } else {
    setDigitEl('digit-s1', s[0], boot);
    setDigitEl('digit-s2', s[1], boot);
  }

  const days   = ['SUNDAY','MONDAY','TUESDAY','WEDNESDAY','THURSDAY','FRIDAY','SATURDAY'];
  const months = ['JAN','FEB','MAR','APR','MAY','JUN','JUL','AUG','SEP','OCT','NOV','DEC'];
  document.getElementById('dateDisplay').textContent =
    `${days[now.getDay()]}, ${months[now.getMonth()]} ${now.getDate()} ${now.getFullYear()}`;
}

function applyNeonColor(name) {
  const c = neonColors[name];
  document.querySelectorAll('.tube-digit.on').forEach(d => {
    d.style.color = c.color;
    d.style.textShadow = `0 0 8px ${c.color},0 0 18px ${c.g1},0 0 36px ${c.g1},0 0 70px ${c.g2}`;
  });
  document.querySelectorAll('.tube-glass.active').forEach(g => {
    g.style.boxShadow = `0 0 18px ${c.g2.replace('0.5','0.38')},0 0 36px ${c.g2.replace('0.5','0.14')},0 4px 18px rgba(0,0,0,0.6),2px 0 8px rgba(0,0,0,0.4) inset`;
    g.querySelector('.tube-glow-inner').style.background =
      `radial-gradient(ellipse at 50% 65%, ${c.bg} 0%, transparent 70%)`;
  });
  const ring = document.querySelector('.power-switch.active .switch-ring');
  if (ring) ring.style.boxShadow = `0 0 18px ${c.g2.replace('0.5','0.6')},0 0 36px ${c.g2.replace('0.5','0.2')},0 5px 18px rgba(0,0,0,0.6),0 2px 3px rgba(255,255,255,0.04) inset`;
  document.querySelectorAll('.sep-dot').forEach(d => {
    d.style.background = c.color;
    d.style.boxShadow  = `0 0 8px ${c.color},0 0 16px ${c.color}`;
  });
}

function getActiveGlassIds() {
  return isMobile()
    ? ['glass-h1','glass-h2','glass-m1','glass-m2','glass-s1m','glass-s2m']
    : ['glass-h1','glass-h2','glass-m1','glass-m2','glass-s1','glass-s2'];
}

function activateTubes(boot) {
  getActiveGlassIds().forEach((id, i) => {
    setTimeout(() => {
      const g = document.getElementById(id);
      if (g) g.classList.add('active');
    }, i * 55);
  });
  setTimeout(() => applyNeonColor(currentColor), 30);
}

function deactivateTubes() {
  document.querySelectorAll('.tube-glass').forEach(g => {
    g.classList.remove('active');
    g.style.boxShadow = '';
    const inner = g.querySelector('.tube-glow-inner');
    if (inner) inner.style.background = '';
  });
  document.querySelectorAll('.sep-dot').forEach(d => {
    d.style.background = '';
    d.style.boxShadow  = '';
  });
}

function getActiveSepIds() {
  return isMobile() ? ['sep1','sep2m'] : ['sep1','sep2'];
}

function getActiveLabelIds() {
  return isMobile() ? ['lbl-h','lbl-m','lbl-sm'] : ['lbl-h','lbl-m','lbl-s'];
}

function setColor(name) {
  currentColor = name;
  document.querySelectorAll('.color-dot').forEach(d => d.classList.remove('active'));
  document.querySelector(`[data-color="${name}"]`).classList.add('active');
  applyNeonColor(name);
  if (isOn) updateAllDigits();
}

function toggleClock() {
  isOn = !isOn;
  const btn    = document.getElementById('powerSwitch');
  const status = document.getElementById('statusText');
  const picker = document.getElementById('colorPicker');
  const date   = document.getElementById('dateDisplay');

  if (isOn) {
    btn.classList.add('active');
    status.textContent = 'ACTIVE';
    status.classList.remove('off'); status.classList.add('on');
    getActiveSepIds().forEach(id => { const el=document.getElementById(id); if(el) el.classList.add('visible'); });
    getActiveLabelIds().forEach(id => { const el=document.getElementById(id); if(el) el.classList.add('visible'); });
    picker.classList.add('visible');
    date.classList.add('visible');
    document.body.classList.add('clock-on');
    updateAllDigits(true);
    activateTubes(true);
    clockInterval = setInterval(() => updateAllDigits(), 1000);
  } else {
    btn.classList.remove('active');
    status.textContent = 'STANDBY';
    status.classList.remove('on'); status.classList.add('off');
    document.querySelectorAll('.separator').forEach(s => s.classList.remove('visible'));
    document.querySelectorAll('.tube-label').forEach(l => l.classList.remove('visible'));
    picker.classList.remove('visible');
    date.classList.remove('visible');
    document.body.classList.remove('clock-on');
    clearInterval(clockInterval);
    deactivateTubes();
    document.querySelectorAll('.tube-digit').forEach(el => {
      el.classList.remove('on');
      el.classList.add('off');
      el.style.color = '';
      el.style.textShadow = '';
    });
    const ring = document.querySelector('.power-switch .switch-ring');
    if (ring) ring.style.boxShadow = '';
  }
}

function toggleTheme() {
  const html = document.documentElement;
  const light = html.getAttribute('data-theme') === 'light';
  html.setAttribute('data-theme', light ? 'dark' : 'light');
  document.getElementById('themeIcon').textContent  = light ? '‚òÄÔ∏è' : 'üåô';
  document.getElementById('themeLabel').textContent = light ? 'LIGHT' : 'DARK';
}

// Show dim digits on load
updateAllDigits();
</script>
</body>
</html>
